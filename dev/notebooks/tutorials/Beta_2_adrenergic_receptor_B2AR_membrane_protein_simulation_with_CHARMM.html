
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM &#8212; OpenMM Cookbook &amp; Tutorials dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/notebooks.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="HSP90 with ADP:Mg2+ simulation" href="HSP90_with_ADPMg2_simulation.html" />
    <link rel="prev" title="Alchemical free energy calculations" href="Alchemical_free_energy_calculations.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="nbsphinx-prolog">
    <a href="Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.ipynb">Download Notebook</a>
    <a href="https://github.com/openmm/openmm-cookbook/blob/main/notebooks/tutorials/Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.ipynb">View in GitHub</a>
    <a href="https://colab.research.google.com/github/openmm/openmm-cookbook/blob/gh-pages/dev/colab/notebooks/tutorials/Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.ipynb">Open in Google Colab</a>
</div><span class="target" id="index-0"></span><section id="Beta-2-adrenergic-receptor-(B2AR)-membrane-protein-simulation-with-CHARMM">
<h1>Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM<a class="headerlink" href="#Beta-2-adrenergic-receptor-(B2AR)-membrane-protein-simulation-with-CHARMM" title="Permalink to this headline">¶</a></h1>
<p><em>Use CHARMM-GUI to set up a membrane protein simulation for OpenMM.</em></p>
<section id="Files">
<h2>Files<a class="headerlink" href="#Files" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The initial membrane protein PDB file <a class="reference external" href="https://openmm.org/tutorials_/b2ar_membrane/files/apo_snapshot.pdb">apo_snapshot.pdb</a> comes from reference structures provided in Kohloff et.al. 2014, originally from PDB ID: 3POG.</p></li>
<li><p>A tarball of the CHARMM-GUI output can be found in <a class="reference external" href="https://openmm.org/tutorials_/b2ar_membrane/files/charmm-gui.zip">charmm-gui.zip</a></p></li>
</ul>
</section>
<section id="Using-CHARMM-GUI-to-embed-B2AR-in-a-solvated-membrane">
<h2>Using CHARMM-GUI to embed B2AR in a solvated membrane<a class="headerlink" href="#Using-CHARMM-GUI-to-embed-B2AR-in-a-solvated-membrane" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="http://www.charmm-gui.org/?doc=input/membrane">CHARMM-GUI’s membrane builder</a> and upload the pdb file. (<code class="docutils literal notranslate"><span class="pre">apo_snapshot.pdb</span></code>). Select PDB format and click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
<li><p>Stick with the default selection (Protein) and click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Terminal</span> <span class="pre">group</span> <span class="pre">patching</span></code> and select termin <code class="docutils literal notranslate"><span class="pre">NTER</span></code> and <code class="docutils literal notranslate"><span class="pre">CTER</span></code>.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Disulfide</span> <span class="pre">bonds</span></code> for the pairs <code class="docutils literal notranslate"><span class="pre">184-190</span></code> and <code class="docutils literal notranslate"><span class="pre">106-191</span></code> and click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Align</span> <span class="pre">the</span> <span class="pre">First</span> <span class="pre">Principal</span> <span class="pre">Axis</span> <span class="pre">Along</span> <span class="pre">Z</span></code>(the suggestion for a homo-oligomer) and click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
<li><p>Keep the default selections for <code class="docutils literal notranslate"><span class="pre">Heterogeneous</span> <span class="pre">Lipid</span></code>, <code class="docutils literal notranslate"><span class="pre">Rectangular</span> <span class="pre">Box</span> <span class="pre">Type</span></code>, <code class="docutils literal notranslate"><span class="pre">17.5</span> <span class="pre">water</span> <span class="pre">thickness</span></code>. Select <code class="docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">lipid</span> <span class="pre">components</span></code> and select <code class="docutils literal notranslate"><span class="pre">POPC</span></code> lipids with <code class="docutils literal notranslate"><span class="pre">55</span></code> lipids on the upperleaflet and lowerleaflet. Click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
<li><p>Keep all default selections (<code class="docutils literal notranslate"><span class="pre">Replacement</span> <span class="pre">method</span></code>, <code class="docutils literal notranslate"><span class="pre">check</span> <span class="pre">lipid</span> <span class="pre">ring</span> <span class="pre">(and</span> <span class="pre">protein</span> <span class="pre">surface)</span> <span class="pre">penetration</span></code>, <code class="docutils literal notranslate"><span class="pre">Include</span> <span class="pre">Ions</span> <span class="pre">0.15</span> <span class="pre">KCl</span></code> and <code class="docutils literal notranslate"><span class="pre">Ion</span> <span class="pre">Placing</span> <span class="pre">Method:</span> <span class="pre">Monte-Carlo</span></code>. Click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code> to assemble components. When you arrive at <code class="docutils literal notranslate"><span class="pre">Step</span> <span class="pre">5</span></code>, select <code class="docutils literal notranslate"><span class="pre">OpenMM</span></code> as the Input generation option. Keep all the other default options (<code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">grid</span> <span class="pre">information</span> <span class="pre">for</span> <span class="pre">PME</span> <span class="pre">FFT</span> <span class="pre">automatically</span></code> and <code class="docutils literal notranslate"><span class="pre">NPT</span> <span class="pre">ensemble</span></code>. Click <code class="docutils literal notranslate"><span class="pre">Next</span> <span class="pre">Step</span></code>.</p></li>
</ol>
<img alt="b2ar_membrane" src="../../_images/b2ar_membrane.jpeg" />
</section>
<section id="Simulating-the-system-in-OpenMM">
<h2>Simulating the system in OpenMM<a class="headerlink" href="#Simulating-the-system-in-OpenMM" title="Permalink to this headline">¶</a></h2>
<section id="The-quick-way">
<h3>The quick way<a class="headerlink" href="#The-quick-way" title="Permalink to this headline">¶</a></h3>
<p>From the <code class="docutils literal notranslate"><span class="pre">charmm-gui.tgz</span></code> extract <code class="docutils literal notranslate"><span class="pre">toppar/</span></code> directory and the <code class="docutils literal notranslate"><span class="pre">openmm/</span></code> directory. The <code class="docutils literal notranslate"><span class="pre">README</span></code> file in the <code class="docutils literal notranslate"><span class="pre">openmm/</span></code> directory is a csh script to run a standard equilibration and production simulation.</p>
</section>
</section>
<section id="The-flexible-way">
<h2>The flexible way<a class="headerlink" href="#The-flexible-way" title="Permalink to this headline">¶</a></h2>
<p>If you want finer control, you can write your own OpenMM code to equilibrate and simulate the system.</p>
<p>OpenMM can directly read CHARMM input files through the use of the <code class="docutils literal notranslate"><span class="pre">openmm.app</span></code> application layer. This enables the use of all the powerful setup tools in the CHARMM ecosystem that a user might be familiar with such as the <a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1002/jcc.20945/abstract">CHARMM-GUI</a>, <a class="reference external" href="http://www.sciencedirect.com/science/article/pii/0263785596000185?via%3Dihub">VMD</a>, <a class="reference external" href="https://cgenff.paramchem.org/">CGenFF</a> program
(<a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1002/jcc.21367/abstract">DOI:10.1002/jcc.21367</a>), etc. This allows users who are already working in the CHARMM environment to harness the GPU speeds that OpenMM provides without having to modify their simulation system description files.</p>
<p>OpenMM can also read CHARMM force field files making it is possible to use force fields that aren’t already included in OpenMM such as the general CHARMM force field (CGenFF). For example, a user can generate an <code class="docutils literal notranslate"><span class="pre">str</span></code> file with the <a class="reference external" href="https://cgenff.paramchem.org/">CGenFF program</a> for a ligand and load it into OpenMM. However, when using this feature, the <code class="docutils literal notranslate"><span class="pre">CharmmParameterSet</span></code> class needs to be used instead of the <code class="docutils literal notranslate"><span class="pre">ForceField</span></code> class to load all the other CHARMM force field files as
demonstrated in the example in the code below.</p>
<p>The example demonstrates how to use CHARMMM files that were generated with the CHARMM-GUI in an OpenMM script. The OpenMM app layer includes several classes to load CHARMM files. The <code class="docutils literal notranslate"><span class="pre">CharmmPsfFile</span></code> class reads the <code class="docutils literal notranslate"><span class="pre">psf</span></code> file and instantiates a chemical structure on which one can then call the <code class="docutils literal notranslate"><span class="pre">createSystem()</span></code> method to creates an OpenMM system object. For the atomic coordinates, a regular pdb file can be used or the <code class="docutils literal notranslate"><span class="pre">CharmmCrdFile</span></code> or <code class="docutils literal notranslate"><span class="pre">CharmmRstFile</span></code> classes can be used to read CHARMM
coordinate files. Files containing force field definitions come in a variety of formats such as <code class="docutils literal notranslate"><span class="pre">prm</span></code>, <code class="docutils literal notranslate"><span class="pre">par</span></code>, <code class="docutils literal notranslate"><span class="pre">top</span></code>, <code class="docutils literal notranslate"><span class="pre">rtf</span></code>, <code class="docutils literal notranslate"><span class="pre">inp</span></code> and <code class="docutils literal notranslate"><span class="pre">str</span></code>. These files are loaded into a <code class="docutils literal notranslate"><span class="pre">CharmmParameterSet</span></code> object which is then included as the first parameter when <code class="docutils literal notranslate"><span class="pre">createSystem()</span></code> is called on the chemical structure. For this example, the <a class="reference external" href="http://dx.doi.org/10.1371/journal.pone.0000880">membrane builder</a> in the CHARMM-GUI was used to generate the input files for the B2AR in a POPC lipid
membrane. The membrane builder provides a straightforward way to go from the RCSB X-ray structure to the protein embedded in a membrane with all the relevant CHARMM input files.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download and extract the files</span>
<span class="o">!</span>wget<span class="w"> </span>https://openmm.org/tutorials_/b2ar_membrane/files/charmm-gui.zip
<span class="o">!</span>tar<span class="w"> </span>xvf<span class="w"> </span>charmm-gui.zip
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="kn">from</span> <span class="nn">openmm.app</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">openmm</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">openmm.unit</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">stdout</span>

<span class="c1"># Load CHARMM files</span>
<span class="n">psf</span> <span class="o">=</span> <span class="n">CharmmPsfFile</span><span class="p">(</span><span class="s1">&#39;charmm-gui/openmm/step5_charmm2omm.psf&#39;</span><span class="p">)</span>
<span class="n">pdb</span> <span class="o">=</span> <span class="n">PDBFile</span><span class="p">(</span><span class="s1">&#39;charmm-gui/openmm/step5_charmm2omm.pdb&#39;</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">CharmmParameterSet</span><span class="p">(</span><span class="s1">&#39;charmm-gui/toppar/par_all36_prot.prm&#39;</span><span class="p">,</span> <span class="s1">&#39;charmm-gui/toppar/top_all36_prot.rtf&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;charmm-gui/toppar/par_all36_lipid.prm&#39;</span><span class="p">,</span> <span class="s1">&#39;charmm-gui/toppar/top_all36_lipid.rtf&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;charmm-gui/toppar/toppar_water_ions.str&#39;</span><span class="p">)</span>

<span class="c1"># Create an openmm system by calling createSystem on psf</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">psf</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">nonbondedMethod</span><span class="o">=</span><span class="n">CutoffNonPeriodic</span><span class="p">,</span>
         <span class="n">nonbondedCutoff</span><span class="o">=</span><span class="mi">1</span><span class="o">*</span><span class="n">nanometer</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">HBonds</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">LangevinIntegrator</span><span class="p">(</span><span class="mi">300</span><span class="o">*</span><span class="n">kelvin</span><span class="p">,</span>   <span class="c1"># Temperature of head bath</span>
                                <span class="mi">1</span><span class="o">/</span><span class="n">picosecond</span><span class="p">,</span> <span class="c1"># Friction coefficient</span>
                                <span class="mf">0.002</span><span class="o">*</span><span class="n">picoseconds</span><span class="p">)</span> <span class="c1"># Time step</span>


<span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">psf</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">pdb</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimizing...&quot;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">minimizeEnergy</span><span class="p">()</span>

<span class="c1"># Set up the reporters to report energies every 1000 steps.</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBReporter</span><span class="p">(</span><span class="s1">&#39;output.pdb&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">StateDataReporter</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="c1"># run simulation</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Alchemical_free_energy_calculations.html" title="Previous document">Alchemical free energy calculations</a>
        </li>
        <li>
          <a href="HSP90_with_ADPMg2_simulation.html" title="Next document">HSP90 with ADP:Mg2+ simulation</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">OpenMM Cookbook & Tutorials</h1>
    
  </a>
</p>











<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="navigation-scrollbox">
    <div class="nav-toctree">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cookbook.html">The OpenMM Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">The OpenMM Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basic-tutorials">Basic Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#advanced-tutorials">Advanced Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Alchemical_free_energy_calculations.html">Alchemical free energy calculations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Files">Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Using-CHARMM-GUI-to-embed-B2AR-in-a-solvated-membrane">Using CHARMM-GUI to embed B2AR in a solvated membrane</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Simulating-the-system-in-OpenMM">Simulating the system in OpenMM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#The-flexible-way">The flexible way</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="HSP90_with_ADPMg2_simulation.html">HSP90 with ADP:Mg2+ simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html">Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Histone_methyltransferase_simulation_with_multisite_Zn2_structural_ions.html">Histone methyltransferase simulation with multisite Zn2+ structural ions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running_a_REST_simulation.html">Run a REST simulation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    
    <ul class="extra-nav-links">
        
        <li class="toctree-l1">
            <a href="https://openmm.org">
                OpenMM.org
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="http://docs.openmm.org/latest/userguide/">
                User's Manual
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="http://docs.openmm.org/latest/developerguide/">
                Developer Guide
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="http://docs.openmm.org/latest/api-c++/">
                C++ API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="http://docs.openmm.org/latest/api-python/">
                Python API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://github.com/openmm/openmm">
                GitHub
            </a>
        </li>
        
    </ul>
    
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, The OpenMM Contributors.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/notebooks/tutorials/Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>