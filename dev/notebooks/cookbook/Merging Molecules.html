<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Merging Molecules in a Topology &#8212; OpenMM Cookbook &amp; Tutorials dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/notebooks.css?v=9b8a9a20" />
    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adding Hydrogens to Nonstandard Molecules" href="Adding%20Hydrogens%20to%20Nonstandard%20Molecules.html" />
    <link rel="prev" title="Saving Systems to XML Files" href="Saving%20Systems%20to%20XML%20Files.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="nbsphinx-prolog">
    <a href="Merging Molecules.ipynb">Download Notebook</a>
    <a href="https://github.com/openmm/openmm-cookbook/blob/main/notebooks/cookbook/Merging Molecules.ipynb">View in GitHub</a>
    <a href="https://colab.research.google.com/github/openmm/openmm-cookbook/blob/gh-pages/dev/colab/notebooks/cookbook/Merging Molecules.ipynb">Open in Google Colab</a>
</div><span class="target" id="index-0"></span><section id="Merging-Molecules-in-a-Topology">
<h1>Merging Molecules in a Topology<a class="headerlink" href="#Merging-Molecules-in-a-Topology" title="Link to this heading">¶</a></h1>
<p>When building models of molecular systems, you sometimes need to merge together pieces that come from different sources. For example, you might have a protein in one PDB file and a ligand in another PDB file. You want to combine them into a single Topology object that can be passed to <code class="docutils literal notranslate"><span class="pre">ForceField.createSystem()</span></code>.</p>
<p>Let’s start by loading two PDB files.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">openmm.app</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">pdb1</span> <span class="o">=</span> <span class="n">PDBFile</span><span class="p">(</span><span class="s1">&#39;villin.pdb&#39;</span><span class="p">)</span>
<span class="n">pdb2</span> <span class="o">=</span> <span class="n">PDBFile</span><span class="p">(</span><span class="s1">&#39;ala_ala_ala.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can now use the Modeller class to merge them together.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeller</span> <span class="o">=</span> <span class="n">Modeller</span><span class="p">(</span><span class="n">pdb1</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">pdb1</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
<span class="n">modeller</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pdb2</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">pdb2</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
<span class="n">mergedTopology</span> <span class="o">=</span> <span class="n">modeller</span><span class="o">.</span><span class="n">topology</span>
<span class="n">mergedPositions</span> <span class="o">=</span> <span class="n">modeller</span><span class="o">.</span><span class="n">positions</span>
</pre></div>
</div>
</div>
<p>This code simply combines the two files without any concern for how the molecules are positioned relative to each other. In practice, combining molecules requires care to select their positions. This might be done by hand in a visualization program, or by a docking code, or in various other ways. It is up to you to select the positions.</p>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Saving%20Systems%20to%20XML%20Files.html" title="Previous document">Saving Systems to XML Files</a>
        </li>
        <li>
          <a href="Adding%20Hydrogens%20to%20Nonstandard%20Molecules.html" title="Next document">Adding Hydrogens to Nonstandard Molecules</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo" />
    
    <h1 class="logo logo-name">OpenMM Cookbook & Tutorials</h1>
    
  </a>
</p>











<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="navigation-scrollbox">
    <div class="nav-toctree">
    <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../cookbook.html">The OpenMM Cookbook</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../cookbook.html#getting-started">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../cookbook.html#simulation-protocols">Simulation Protocols</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Changing%20Temperature%20and%20Pressure.html">Changing Temperature and Pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="Saving%20Systems%20to%20XML%20Files.html">Saving Systems to XML Files</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Merging Molecules in a Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="Adding%20Hydrogens%20to%20Nonstandard%20Molecules.html">Adding Hydrogens to Nonstandard Molecules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook.html#restraints-constraints-and-external-forces">Restraints, Constraints, and External Forces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook.html#analysis-and-system-inspection">Analysis and System Inspection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">The OpenMM Tutorials</a></li>
</ul>

    </div>
    
    <ul class="extra-nav-links">
        
        <li class="toctree-l1">
            <a href="https://openmm.org">
                OpenMM.org
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/userguide/">
                User's Manual
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/developerguide/">
                Developer Guide
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/api-c++/">
                C++ API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/api-python/">
                Python API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://github.com/openmm/openmm">
                GitHub
            </a>
        </li>
        
    </ul>
    
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, The OpenMM Contributors.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/notebooks/cookbook/Merging Molecules.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>