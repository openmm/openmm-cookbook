<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Histone methyltransferase simulation with multisite Zn2+ structural ions &#8212; OpenMM Cookbook &amp; Tutorials dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=a0d4cc31" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/notebooks.css?v=9b8a9a20" />
    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Run a REST simulation" href="Running_a_REST_simulation.html" />
    <link rel="prev" title="Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)" href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="nbsphinx-prolog">
    <a href="Histone_methyltransferase_simulation_with_multisite_Zn2_structural_ions.ipynb">Download Notebook</a>
    <a href="https://github.com/openmm/openmm-cookbook/blob/main/notebooks/tutorials/Histone_methyltransferase_simulation_with_multisite_Zn2_structural_ions.ipynb">View in GitHub</a>
    <a href="https://colab.research.google.com/github/openmm/openmm-cookbook/blob/gh-pages/dev/colab/notebooks/tutorials/Histone_methyltransferase_simulation_with_multisite_Zn2_structural_ions.ipynb">Open in Google Colab</a>
</div><span class="target" id="index-0"></span><section id="Histone-methyltransferase-simulation-with-multisite-Zn2+-structural-ions">
<h1>Histone methyltransferase simulation with multisite Zn2+ structural ions<a class="headerlink" href="#Histone-methyltransferase-simulation-with-multisite-Zn2+-structural-ions" title="Link to this heading">¶</a></h1>
<p><em>Simulating a protein with structural zinc ions using multisite ions.</em></p>
<p>This tutorial is described in <a class="reference external" href="http://dx.doi.org/10.1371/journal.pcbi.1005659">OpenMM 7</a> publication.</p>
<section id="Files">
<h2>Files<a class="headerlink" href="#Files" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>All input files can be found in <a class="reference external" href="https://openmm.org/tutorials_/hkmt_zinc/files/hkmt_zinc.zip">hkmt_zinc.zip</a></p></li>
</ul>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">¶</a></h2>
<p>OpenMM allows users to model their systems using Amber and provide <code class="docutils literal notranslate"><span class="pre">prmtop</span></code>, and <code class="docutils literal notranslate"><span class="pre">inpcrd</span></code> files as input. This allows users more familiar with the Amber modeling environment to continue using their setup tools, while harnessing the speed and versatility of OpenMM. This also allows the use of non-standard force fields that have been published for use with Amber, such as metal ion models where dummy atoms are applied to mimic particular coordination geometries. Furthermore, this is facilitated
by OpenMM’s support for <a class="reference external" href="http://docs.openmm.org/latest/userguide/application/03_model_building_editing.html#adding-or-removing-extra-particles">Extra Particles</a> which are particles that are not ordinary atoms, such as these metal dummy atoms, virtual sites in many water models, etc.</p>
<p>This example illustrates the use of <code class="docutils literal notranslate"><span class="pre">tleap</span></code> from <a class="reference external" href="http://ambermd.org/">AmberTools</a> to set up a simulation of the histone methyltransferase SETD2 (Uniprot: <a class="reference external" href="http://www.uniprot.org/uniprot/Q9BYW2">Q9BYW2</a>), including three structural Zn2+ cations described with the tetrahedral Cationic Dummy Atom Approach (CADA: <a class="reference external" href="https://dx.doi.org/10.1007/s008940050119">DOI:10.1007/s008940050119</a>, <a class="reference external" href="http://www.mayo.edu/research/labs/computer-aided-molecular-design/projects/zinc-protein-simulations-using-cationic-dummy-atom-cada-approach">Pang
lab</a>).</p>
<p>We begin from the <a class="reference external" href="http://www.rcsb.org/pdb/explore.do?structureId=4h12">4H12</a> PDB file, add missing residues (only those in the middle of the chain) and missing heavy atoms using <a class="reference external" href="https://github.com/openmm/pdbfixer">PDBFixer</a>, and remove unwanted water and ligand residues using <a class="reference external" href="http://mdtraj.org/">MDTraj</a>. The CADA model requires particular naming of those residues, as well as deprotonation of the ligating cysteine sulfurs (i.e. their names are changed from CYS to CYM). Finally,
<code class="docutils literal notranslate"><span class="pre">tleap</span></code> is run to add hydrogens, the Zn2+ dummy atoms and parametrize. We use the <code class="docutils literal notranslate"><span class="pre">ff99SBildn</span></code> force field and <code class="docutils literal notranslate"><span class="pre">znb.lib</span></code>, and <code class="docutils literal notranslate"><span class="pre">frcmod.zinc</span></code> files from the CADA model (downloaded from Pang lab). The <code class="docutils literal notranslate"><span class="pre">prmtop</span></code> and <code class="docutils literal notranslate"><span class="pre">inpcrd</span></code> files are saved for simulation in OpenMM.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and unzip the inputfiles</span>
<span class="o">!</span>wget<span class="w"> </span>https://openmm.org/tutorials_/hkmt_zinc/files/hkmt_zinc.zip
<span class="o">!</span>unzip<span class="w"> </span>-o<span class="w"> </span>hkmt_zinc.zip
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pdbfixer</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDBFixer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openmm.app</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDBFile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mdtraj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">md</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># clean up the original PDB file and add missing residues and heavy atoms</span>
<span class="n">fixer</span> <span class="o">=</span> <span class="n">PDBFixer</span><span class="p">(</span><span class="s1">&#39;pdb4h12.ent&#39;</span><span class="p">)</span>


<span class="n">fixer</span><span class="o">.</span><span class="n">findMissingResidues</span><span class="p">()</span>
<span class="c1"># only add missing residues in the middle of the chain, do not add terminal ones</span>
<span class="n">chains</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fixer</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">chains</span><span class="p">())</span>
<span class="n">keys</span> <span class="o">=</span> <span class="n">fixer</span><span class="o">.</span><span class="n">missingResidues</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">missingResidues</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="n">chains</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">()))):</span>
        <span class="n">missingResidues</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fixer</span><span class="o">.</span><span class="n">missingResidues</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="n">fixer</span><span class="o">.</span><span class="n">missingResidues</span> <span class="o">=</span> <span class="n">missingResidues</span>

<span class="n">fixer</span><span class="o">.</span><span class="n">findMissingAtoms</span><span class="p">()</span>
<span class="n">fixer</span><span class="o">.</span><span class="n">addMissingAtoms</span><span class="p">()</span>

<span class="n">PDBFile</span><span class="o">.</span><span class="n">writeFile</span><span class="p">(</span><span class="n">fixer</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">fixer</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;4h12_fixed.pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span>

<span class="c1"># keep only protein and zinc ions</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;4h12_fixed.pdb&#39;</span><span class="p">)</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">atom_slice</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;(protein and not resname SAH) or resname ZN&#39;</span><span class="p">))</span>

<span class="c1"># implement changes necessary for the use of the dummy atom Zn2+ model</span>
<span class="c1"># change residue name of the zincs from ZN to ZNB, and atom names from ZN to Zn</span>
<span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
    <span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;ZNB&#39;</span>
<span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
    <span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Zn&#39;</span>

<span class="c1"># change name of cysteines coordinating zincs to CYM (deprotonated cysteine)</span>
<span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">86</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">231</span><span class="p">]:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;CYM&#39;</span>

<span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;4h12_fixed_protein_zn_only.pdb&#39;</span><span class="p">)</span>

<span class="c1"># save the tleap script to file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;leaprc.setd2&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">source oldff/leaprc.ff99SBildn</span>
<span class="s1">addAtomTypes { { &quot;DZ&quot; &quot;Zn&quot; &quot;sp3&quot; } { &quot;Zn&quot; &quot;Zn&quot; &quot;sp3&quot; } }</span>
<span class="s1">loadOff znb.lib</span>
<span class="s1">loadamberparams frcmod.zinc</span>
<span class="s1">x = loadPdb 4h12_fixed_protein_zn_only.pdb</span>
<span class="s1">addIons x Cl- 0</span>
<span class="s1">solvateBox x TIP3PBOX 10.0</span>
<span class="s1">savePdb x topology.pdb</span>
<span class="s1">saveAmberParm x input.prmtop input.inpcrd</span>
<span class="s1">quit</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># run tleap</span>

<span class="c1"># if you have amber tools installed on your system you can uncomment and run this line</span>
<span class="c1">#os.system(&#39;tleap -f leaprc.setd2&#39;)</span>

<span class="c1"># we have included the output files that get produced:</span>
<span class="c1"># input.inpcrd and input.prmtop</span>
</pre></div>
</div>
</div>
<p>We load the <code class="docutils literal notranslate"><span class="pre">prmtop</span></code> and <code class="docutils literal notranslate"><span class="pre">inpcrd</span></code> files in, by creating <code class="docutils literal notranslate"><span class="pre">AmberPrmtopFile</span></code> and <code class="docutils literal notranslate"><span class="pre">AmberInpcrdFile</span></code> objects. Next, the <code class="docutils literal notranslate"><span class="pre">System</span></code> is created by calling the createSystem() method on the AmberPrmtopFile object.</p>
<p>Next, the <code class="docutils literal notranslate"><span class="pre">LangevinIntegrator</span></code> and the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> are set up, using the topology from the AmberPrmtopFile and positions from the AmberInpcrdFile. In this example we will use the CUDA platform, with mixed precision. The simulation is energy minimized and equilibrated for 100 steps. Reporters are attached and the production simulation propagated for 50 ns.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="kn">import</span> <span class="n">unit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdout</span>

<span class="c1"># load in Amber input files</span>
<span class="n">prmtop</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">AmberPrmtopFile</span><span class="p">(</span><span class="s1">&#39;input.prmtop&#39;</span><span class="p">)</span>
<span class="n">inpcrd</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">AmberInpcrdFile</span><span class="p">(</span><span class="s1">&#39;input.inpcrd&#39;</span><span class="p">)</span>

<span class="c1"># prepare system and integrator</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">prmtop</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="n">nonbondedMethod</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">PME</span><span class="p">,</span>
    <span class="n">nonbondedCutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">HBonds</span><span class="p">,</span> <span class="n">rigidWater</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ewaldErrorTolerance</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">LangevinIntegrator</span><span class="p">(</span><span class="mi">300</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">kelvin</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">unit</span><span class="o">.</span><span class="n">picoseconds</span><span class="p">,</span>
    <span class="mf">2.0</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">femtoseconds</span><span class="p">)</span>
<span class="n">integrator</span><span class="o">.</span><span class="n">setConstraintTolerance</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>


<span class="n">simulation</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">prmtop</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
    <span class="c1">#properties)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">inpcrd</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

<span class="c1"># minimize</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minimizing...&#39;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">minimizeEnergy</span><span class="p">()</span>

<span class="c1"># equilibrate for 100 steps</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setVelocitiesToTemperature</span><span class="p">(</span><span class="mi">300</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">kelvin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Equilibrating...&#39;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># append reporters</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">DCDReporter</span><span class="p">(</span><span class="s1">&#39;trajectory.dcd&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">StateDataReporter</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remainingTime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">speed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">totalSteps</span><span class="o">=</span><span class="mi">25000000</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="c1"># run 50 ns of production simulation</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running Production...&#39;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">25000000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally, we perform a quick analysis of the trajectory. We examine the RMSD of all frames to the first frame, and the mean sulfur - zinc distances to check the stability of the metal centers.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">mdtraj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">md</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># load trajectory and remove solvent</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load_dcd</span><span class="p">(</span><span class="s1">&#39;trajectory.dcd&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">&#39;topology.pdb&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">atom_slice</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;protein or resname ZNB&#39;</span><span class="p">))</span>

<span class="c1"># calculate RMSD to first frame and plot figure</span>
<span class="n">rmsd</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">rmsd</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">traj</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rmsd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;RMSD to first frame&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame (0.1 ns/frame)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RMSD (nm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;rmsd.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># calculate mean sulfur - zinc distances for 3 metal centers and plot figure</span>
<span class="n">atom_pairs_1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3904</span><span class="p">,</span> <span class="mi">892</span><span class="p">],</span> <span class="p">[</span><span class="mi">3904</span><span class="p">,</span> <span class="mi">917</span><span class="p">],</span> <span class="p">[</span><span class="mi">3904</span><span class="p">,</span> <span class="mi">1136</span><span class="p">],</span> <span class="p">[</span><span class="mi">3904</span><span class="p">,</span> <span class="mi">1180</span><span class="p">]]</span>
<span class="n">atom_pairs_2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3909</span><span class="p">,</span> <span class="mi">1136</span><span class="p">],</span> <span class="p">[</span><span class="mi">3909</span><span class="p">,</span> <span class="mi">1336</span><span class="p">],</span> <span class="p">[</span><span class="mi">3909</span><span class="p">,</span> <span class="mi">1392</span><span class="p">],</span> <span class="p">[</span><span class="mi">3909</span><span class="p">,</span> <span class="mi">1470</span><span class="p">]]</span>
<span class="n">atom_pairs_3</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3914</span><span class="p">,</span> <span class="mi">2982</span><span class="p">],</span> <span class="p">[</span><span class="mi">3914</span><span class="p">,</span> <span class="mi">3733</span><span class="p">],</span> <span class="p">[</span><span class="mi">3914</span><span class="p">,</span> <span class="mi">3763</span><span class="p">],</span> <span class="p">[</span><span class="mi">3914</span><span class="p">,</span> <span class="mi">3815</span><span class="p">]]</span>

<span class="n">distances_1</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">compute_distances</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">atom_pairs_1</span><span class="p">)</span>
<span class="n">distances_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">distances_1</span><span class="p">]</span>
<span class="n">distances_2</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">compute_distances</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">atom_pairs_2</span><span class="p">)</span>
<span class="n">distances_2</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">distances_2</span><span class="p">]</span>
<span class="n">distances_3</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">compute_distances</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">atom_pairs_3</span><span class="p">)</span>
<span class="n">distances_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">distances_3</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zn1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zn2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances_3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Zn3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean S - Zn distances&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame (0.1 ns/frame)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean S - Zn distance (nm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;zn_s_distances.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><img alt="RMSD" src="../../_images/rmsd.png" /></p>
<p><img alt="zn_s_distances" src="../../_images/zn_s_distances.png" /></p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html" title="Previous document">Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)</a>
        </li>
        <li>
          <a href="Running_a_REST_simulation.html" title="Next document">Run a REST simulation</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.svg" alt="Logo" />
    
    <h1 class="logo logo-name">OpenMM Cookbook & Tutorials</h1>
    
  </a>
</p>











<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="navigation-scrollbox">
    <div class="nav-toctree">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cookbook.html">The OpenMM Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">The OpenMM Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#getting-started">Getting Started</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#beyond-the-basics">Beyond the Basics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="simulation_parameters.html">Selecting Values for Simulation Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="coarse_grained_polymer.html">Coarse-Grained Polymer</a></li>
<li class="toctree-l3"><a class="reference internal" href="Alchemical_free_energy_calculations.html">Alchemical free energy calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.html">Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM</a></li>
<li class="toctree-l3"><a class="reference internal" href="HSP90_with_ADPMg2_simulation.html">HSP90 with ADP:Mg2+ simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html">Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Histone methyltransferase simulation with multisite Zn2+ structural ions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Files">Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Introduction">Introduction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Running_a_REST_simulation.html">Run a REST simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="umbrella_sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    
    <ul class="extra-nav-links">
        
        <li class="toctree-l1">
            <a href="https://openmm.org">
                OpenMM.org
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/userguide/">
                User's Manual
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/developerguide/">
                Developer Guide
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/api-c++/">
                C++ API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/api-python/">
                Python API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://github.com/openmm/openmm">
                GitHub
            </a>
        </li>
        
    </ul>
    
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, The OpenMM Contributors.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/notebooks/tutorials/Histone_methyltransferase_simulation_with_multisite_Zn2_structural_ions.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>