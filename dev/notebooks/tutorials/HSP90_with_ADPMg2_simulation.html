<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>HSP90 with ADP:Mg2+ simulation &#8212; OpenMM Cookbook &amp; Tutorials dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=a0d4cc31" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../../_static/notebooks.css?v=9b8a9a20" />
    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)" href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html" />
    <link rel="prev" title="Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM" href="Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="nbsphinx-prolog">
    <a href="HSP90_with_ADPMg2_simulation.ipynb">Download Notebook</a>
    <a href="https://github.com/openmm/openmm-cookbook/blob/main/notebooks/tutorials/HSP90_with_ADPMg2_simulation.ipynb">View in GitHub</a>
    <a href="https://colab.research.google.com/github/openmm/openmm-cookbook/blob/gh-pages/dev/colab/notebooks/tutorials/HSP90_with_ADPMg2_simulation.ipynb">Open in Google Colab</a>
</div><span class="target" id="index-0"></span><section id="HSP90-with-ADP:Mg2+-simulation">
<h1>HSP90 with ADP:Mg2+ simulation<a class="headerlink" href="#HSP90-with-ADP:Mg2+-simulation" title="Link to this heading">¶</a></h1>
<p><em>Simulating a protein:ligand complex with multisite solvated ions.</em></p>
<section id="Files">
<h2>Files<a class="headerlink" href="#Files" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>All input files can be found in <a class="reference external" href="https://openmm.org/tutorials_/hsp90_adp_mg/files/hsp90_adp_mg.zip">hsp90_adp_mg.zip</a></p></li>
</ul>
</section>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">¶</a></h2>
<p>OpenMM allows users to model their systems using Amber and provide <code class="docutils literal notranslate"><span class="pre">prmtop</span></code>, and <code class="docutils literal notranslate"><span class="pre">inpcrd</span></code> files as input. This allows users more familiar with the <a class="reference external" href="http://ambermd.org/">Amber</a> modeling environment to continue using their setup tools, while harnessing the speed and versatility of OpenMM. This also allows the use of non-standard force fields that have been published for use with Amber, such as metal ion models where dummy atoms are applied to mimic particular coordination geometries.
Furthermore, this is facilitated by OpenMM’s support for Extra Particles—particles that are not ordinary atoms, such as these metal dummy atoms, virtual sites in many water models, etc.</p>
<p>This example illustrates the use of Amber’s tleap to set up a simulation of the Heat Shock Protein 90 (HSP90, Uniprot: <a class="reference external" href="http://www.uniprot.org/uniprot/P07900">P07900</a>, including the ADP-Mg2+ complex, where we will model the Mg2+ cation using the Sept Lab octahedral multisite model (<a class="reference external" href="https://doi.org/10.1021/ct400177g">DOI:10.1021/ct400177g</a>, <a class="reference external" href="http://septlab.engin.umich.edu/multisite-ions.html">Sept Lab</a>), and use the Carlson parameters for ADP
(<a class="reference external" href="https://doi.org/10.1002/jcc.10262">DOI:10.1002/jcc.10262</a>, downloaded from <a class="reference external" href="http://research.bmh.manchester.ac.uk/bryce/amber">Bryce group Amber parameter database</a>).</p>
<p>We begin from the <a class="reference external" href="https://www.rcsb.org/pdb/explore.do?structureId=1BYQ">1BYQ</a> PDB file, add missing residues (only those in the middle of the chain) and missing heavy atoms using PDBFixer. Using <a class="reference external" href="http://mdtraj.org/">MDTraj</a>, residue and atom naming of the Mg2+ ion and the ADP are fixed to match those in the parameter files, and dummy atoms of the multisite Mg2+ are added. <a class="reference external" href="http://www.wwpdb.org/documentation/file-format-content/format33/sect10.html#CONECT">CONECT</a> records for bonds
between Mg2+ and ADP are deleted. Crystallographic waters are preserved for coordination to the Mg2+.</p>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">tleap</span></code> is run to add hydrogens and parametrize. We use the <code class="docutils literal notranslate"><span class="pre">ff99SBildn</span></code> force field, mag.lib and frcmod_mg.mmg files from the multisite Mg2+ model (downloaded from <a class="reference external" href="http://septlab.engin.umich.edu/multisite-ions.html">Sept Lab</a>), ADP.prep and frcmod.phos files for the ADP parameters (downloaded from <a class="reference external" href="http://research.bmh.manchester.ac.uk/bryce/amber">Bryce group Amber parameter database</a>). The prmtop and inpcrd files are saved for simulation in OpenMM. The multisite Mg2+ model
requires a correction to the Lennard-Jones B-coefficients in the prmtop file, this is done by a short Python script (obtained by email from Prof. David Sept, <a class="reference external" href="http://septlab.engin.umich.edu/">Sept Lab</a>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget<span class="w"> </span>https://openmm.org/tutorials_/hsp90_adp_mg/files/hsp90_adp_mg.zip
<span class="o">!</span>unzip<span class="w"> </span>-o<span class="w"> </span>hsp90_adp_mg.zip
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pdbfixer</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDBFixer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openmm.app</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDBFile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mdtraj</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">md</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># clean up the original PDB file and add missing residues and heavy atoms</span>
<span class="n">fixer</span> <span class="o">=</span> <span class="n">PDBFixer</span><span class="p">(</span><span class="s1">&#39;pdb1byq.ent&#39;</span><span class="p">)</span>
<span class="n">fixer</span><span class="o">.</span><span class="n">findMissingResidues</span><span class="p">()</span>

<span class="c1"># only add missing residues in the middle of the chain, do not add terminal ones</span>
<span class="n">chains</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fixer</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">chains</span><span class="p">())</span>
<span class="n">keys</span> <span class="o">=</span> <span class="n">fixer</span><span class="o">.</span><span class="n">missingResidues</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="n">missingResidues</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
    <span class="n">chain</span> <span class="o">=</span> <span class="n">chains</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">residues</span><span class="p">()))):</span>
        <span class="n">missingResidues</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fixer</span><span class="o">.</span><span class="n">missingResidues</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="n">fixer</span><span class="o">.</span><span class="n">missingResidues</span> <span class="o">=</span> <span class="n">missingResidues</span>

<span class="n">fixer</span><span class="o">.</span><span class="n">findMissingAtoms</span><span class="p">()</span>
<span class="n">fixer</span><span class="o">.</span><span class="n">addMissingAtoms</span><span class="p">()</span>

<span class="n">PDBFile</span><span class="o">.</span><span class="n">writeFile</span><span class="p">(</span><span class="n">fixer</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">fixer</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1byq_fixed.pdb&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">))</span>

<span class="n">traj</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;1byq_fixed.pdb&#39;</span><span class="p">)</span>

<span class="c1"># fix residue names</span>
<span class="c1"># in adp - change ` to * in atom names</span>
<span class="c1"># add Mg dummy atoms</span>
<span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MG&#39;</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;MMG&#39;</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;XZ&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="s1">&#39;D</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">md</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Element</span><span class="o">.</span><span class="n">getBySymbol</span><span class="p">(</span><span class="s1">&#39;Mg&#39;</span><span class="p">),</span> <span class="n">residue</span><span class="p">)</span>
        <span class="c1"># add dummy atoms</span>
        <span class="n">central_index</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
        <span class="n">central_positions</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">central_index</span><span class="p">]</span>
        <span class="c1"># positions from magnesium_ms.pdb, Sept Lab: http://septlab.engin.umich.edu/multisite-ions.html</span>
        <span class="n">dummy_positions</span> <span class="o">=</span> <span class="n">central_positions</span> <span class="o">+</span> <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">central_index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dummy_positions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)])</span>
    <span class="k">elif</span> <span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ADP&#39;</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;adp&#39;</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">:</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;*&quot;</span>

<span class="c1"># remove adp - mg CONECT bonds</span>
<span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">_bonds</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">bond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MMG&#39;</span> <span class="ow">or</span> <span class="n">bond</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;MMG&#39;</span><span class="p">):</span>
        <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>

<span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">_bonds</span> <span class="o">=</span> <span class="n">bonds</span>

<span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;1byq_fixed2.pdb&#39;</span><span class="p">)</span>

<span class="c1"># save the tleap script to file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;leaprc.hsp90&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">source oldff/leaprc.ff99SBildn</span>
<span class="s1">loadOff mag.lib</span>
<span class="s1">loadamberparams frcmod_mg.mmg</span>
<span class="s1">loadAmberPrep ADP.prep</span>
<span class="s1">loadamberparams frcmod.phos</span>
<span class="s1">x = loadPdb 1byq_fixed2.pdb</span>
<span class="s1">addIons x Na+ 0</span>
<span class="s1">solvateBox x TIP3PBOX 10.0</span>
<span class="s1">savePdb x topology.pdb</span>
<span class="s1">saveAmberParm x input.prmtop input.inpcrd</span>
<span class="s1">quit</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>

<span class="c1"># run tleap</span>
<span class="c1"># if you have amber tools installed on your system you can uncomment and run this line</span>
<span class="c1">#os.system(&#39;tleap -f leaprc.hsp90&#39;)</span>

<span class="c1"># we have included the output files that get produced:</span>
<span class="c1"># input.inpcrd and input.prmtop</span>

<span class="c1">#!echo input.prmtop | python zeroBvalues.py</span>
<br/></pre></div>
</div>
</div>
<p>We load the <code class="docutils literal notranslate"><span class="pre">prmtop</span></code> and <code class="docutils literal notranslate"><span class="pre">inpcrd</span></code> files in, by creating <code class="docutils literal notranslate"><span class="pre">AmberPrmtopFile</span></code> and <code class="docutils literal notranslate"><span class="pre">AmberInpcrdFile</span></code> objects. Next, the <code class="docutils literal notranslate"><span class="pre">System</span></code> is created by calling the <code class="docutils literal notranslate"><span class="pre">createSystem</span></code> method on the <code class="docutils literal notranslate"><span class="pre">AmberPrmtopFile</span></code> object. Next, the <code class="docutils literal notranslate"><span class="pre">LangevinIntegrator</span></code> and the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> are set up, using the topology from the <code class="docutils literal notranslate"><span class="pre">AmberPrmtopFile</span></code> and positions from the <code class="docutils literal notranslate"><span class="pre">AmberInpcrdFile</span></code>. The simulation is energy minimized and equilibrated for 100 steps. Reporters are attached and the production simulation
propagated for 50 ns.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="kn">import</span> <span class="n">app</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openmm</span><span class="w"> </span><span class="kn">import</span> <span class="n">unit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sys</span><span class="w"> </span><span class="kn">import</span> <span class="n">stdout</span>

<span class="c1"># load in Amber input files</span>
<span class="n">prmtop</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">AmberPrmtopFile</span><span class="p">(</span><span class="s1">&#39;input.prmtop.mod&#39;</span><span class="p">)</span>
<span class="n">inpcrd</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">AmberInpcrdFile</span><span class="p">(</span><span class="s1">&#39;input.inpcrd&#39;</span><span class="p">)</span>

<span class="c1"># prepare system and integrator</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">prmtop</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="n">nonbondedMethod</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">PME</span><span class="p">,</span>
    <span class="n">nonbondedCutoff</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">HBonds</span><span class="p">,</span> <span class="n">rigidWater</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ewaldErrorTolerance</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">LangevinIntegrator</span><span class="p">(</span><span class="mi">300</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">kelvin</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">unit</span><span class="o">.</span><span class="n">picoseconds</span><span class="p">,</span>
    <span class="mf">2.0</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">femtoseconds</span><span class="p">)</span>
<span class="n">integrator</span><span class="o">.</span><span class="n">setConstraintTolerance</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>

<span class="c1"># prepare simulation</span>
<span class="n">simulation</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">prmtop</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">inpcrd</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>

<span class="c1"># minimize</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minimizing...&#39;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">minimizeEnergy</span><span class="p">()</span>

<span class="c1"># equilibrate for 100 steps</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setVelocitiesToTemperature</span><span class="p">(</span><span class="mi">300</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">kelvin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Equilibrating...&#39;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># append reporters</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">DCDReporter</span><span class="p">(</span><span class="s1">&#39;trajectory.dcd&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">StateDataReporter</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remainingTime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">speed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">totalSteps</span><span class="o">=</span><span class="mi">25000000</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="c1"># run 50 ns of production simulation</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running Production...&#39;</span><span class="p">)</span>
<span class="n">simulation</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">25000000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.html" title="Previous document">Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM</a>
        </li>
        <li>
          <a href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html" title="Next document">Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.svg" alt="Logo" />
    
    <h1 class="logo logo-name">OpenMM Cookbook & Tutorials</h1>
    
  </a>
</p>











<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="navigation-scrollbox">
    <div class="nav-toctree">
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../cookbook.html">The OpenMM Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">The OpenMM Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#basic-tutorials">Basic Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html#coarse-graining">Coarse-Graining</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tutorials.html#advanced-tutorials">Advanced Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Alchemical_free_energy_calculations.html">Alchemical free energy calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="Beta_2_adrenergic_receptor_B2AR_membrane_protein_simulation_with_CHARMM.html">Beta-2-adrenergic receptor (B2AR) membrane protein simulation with CHARMM</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">HSP90 with ADP:Mg2+ simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Files">Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Introduction">Introduction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Histone_methyltransferase_simulation_with_a_multisite_water_model_TIP4P-Ew.html">Histone methyltransferase simulation with a multisite water model (TIP4P-Ew)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Histone_methyltransferase_simulation_with_multisite_Zn2_structural_ions.html">Histone methyltransferase simulation with multisite Zn2+ structural ions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Running_a_REST_simulation.html">Run a REST simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="umbrella_sampling.html">Umbrella Sampling</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
    
    <ul class="extra-nav-links">
        
        <li class="toctree-l1">
            <a href="https://openmm.org">
                OpenMM.org
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/userguide/">
                User's Manual
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/developerguide/">
                Developer Guide
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/api-c++/">
                C++ API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://docs.openmm.org/latest/api-python/">
                Python API reference
            </a>
        </li>
        
        <li class="toctree-l1">
            <a href="https://github.com/openmm/openmm">
                GitHub
            </a>
        </li>
        
    </ul>
    
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, The OpenMM Contributors.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/notebooks/tutorials/HSP90_with_ADPMg2_simulation.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>